// constants/pricing.ts - Конфигурация ценообразования
// Извлечено из stores/order.ts для переиспользования

/** Конфигурация ценообразования - входные цены и параметры расчёта.
 * Меняйте здесь — пересчёт на всём сайте.
 */
export const PRICING_CONFIG = {
  /** Общие: ручки 2 шт × 2,2, стрейч, работа. Уголки/крепления — в fixedRamochnaya. Импост — переменная (ширина−48). */
  fixed: {
    handles: 4.4, /* 2 шт × 2,2 руб (ручка + саморез) */
    handlesMetal: 16, /* 2 шт × 8 руб */
    stretch: 24,
    /** Работа: база 60 ₽ + (полотно ₽/м² + профиль ₽/м.п.) × 10% — для всех сеток */
    workBase: 60,
    workPercent: 0.1,
  },
  /** Фикса рамочной: уголки 4×3,75, ручка 2×2,2, крепление 4×10, крепление поперечины 2×1,8 */
  fixedRamochnaya: {
    cornersByColor: { 1: 3.75, 2: 6, 3: 7, 4: 7 }, /* цена за 1 уголок; всего 4 шт */
    mounts: 40, /* 4 шт × 10 руб (крепление металл + саморезы) */
    impostMountCount: 2,
    impostMountPrice: 1.8, /* крепление поперечины, руб за 1 шт */
  },
  /** Фикса вставной VSN: уголки 14,8 ₽/шт × 4; крепление (+клепка) 30 ₽/шт × 4; крепление поперечины 2×1,8 */
  fixedVstavnaya: {
    cornersByColor: { 1: 14.8, 2: 4.85, 3: 7.15, 4: 7.15 }, /* цена за 1 уголок; всего 4 шт */
    mountPerPiece: 30,
    mountCount: 4,
    impostMountCount: 2,
    impostMountPrice: 1.8,
  },
  /** Переменные: цены за погонный метр (профиль рамный + поперечина усреднённо) и шнур */
  variable: {
    /** Цена профиля за м.п. по цветам (1=белая, 2=коричневая, 3=антрацит, 4=RAL) — рамочная */
    profilePerMeter: { 1: 60, 2: 64.8, 3: 70, 4: 60 },
    /** Профиль вставной VSN за м.п. по цветам; RAL = белая + наценка покраски 100 */
    profilePerMeterVstavnaya: { 1: 151, 2: 153, 3: 163, 4: 251 }, /* 4 = RAL: 151 + 100 */
    /** Поперечина за м.п. по цветам (для RAL к белому + наценка покраски) — общая для рамочной и вставной */
    impostPerMeter: { 1: 62, 2: 67.2, 3: 75, 4: 62 },
    /** Наценка покраски RAL: + руб за м.п. к белому профилю/поперечине (рамочные и вставные) */
    ralPaintingPerMeter: 100,
    /** Шнур фиксирующий, руб/м.п. (без запаса) */
    cordPerMeter: 4.6,
    /** Запасы: 15% профиль и поперечина, 32% полотно, шнур без запаса */
    marginProfile: 1.15,
    marginMesh: 1.32,
    marginCord: 1,
    /** Минимальная площадь для расчёта, м² */
    minAreaM2: 0.3,
  },
  /** Цена полотна за м² по типам (входные, без запаса — запас в marginMesh) */
  meshPerM2: {
    standart: 63,
    antimoshka: 265,
    ultravyu: 295,
    antikoshka: 414,
    antipyl: 645,
  },
  /** Наценка: дилер и клиент — только коэффициент от себестоимости, без вычитания. */
  markup: {
    /** Дилер: рамочная 1000×1000 белая стандарт (себ. ≈588) → 840 ₽ */
    dealerFactor: 1.43,
    dealerOffset: 0,
    dealerRound: 10,
    /** Клиент: прямо от себестоимости (≈587 → 1250 для стандарта белая 1000×1000) */
    clientFactorFromCost: 2.13,
    clientOffsetFromCost: 0,
    clientRound: 50,
  },
  /** Доп. услуги в калькуляторе (руб за 1 шт). Ручка ПВХ 2,4 в фиксе; металл +50 к базовой. */
  extras: {
    installation: 400,
    handleMetal: 50,
  },
  /** Потери при оплате (для расчёта прибыли). В админке — редактируемо. */
  fees: {
    /** Комиссия оплаты картой, доля от суммы заказа (клиент и дилер). */
    cardPercent: 0.025,
  },
}

/** Доставка */
export const DELIVERY_OPTIONS = [
  { id: 'Оф.Чебоксары', name: 'Самовывоз Чебоксары Гражданская 53', price: 0, icon: 'building' },
  { id: 'Оф.Новочебоксарск', name: 'Самовывоз Новочебоксарск Винокурова 109', price: 0, icon: 'building' },
  { id: 'Доставка', name: 'Доставка Чебоксары и Новочебоксарск', price: 400, icon: 'truck' }
] as const

export type DeliveryId = typeof DELIVERY_OPTIONS[number]['id']

/** Дополнительные опции */
export const URGENT_ORDER_OPTION = { id: 'srochnyi' as const, name: 'Приоритетный срочный заказ', price: 400 }
export const MEASUREMENT_OPTION = { id: 'measurement', name: 'Замер Чебоксары и Новочебоксарск', price: 400 }
